
<!DOCTYPE html>
<html>
<head>
<title>会员注册--${store.title}</title>
<meta name="keywords" content="{$metaKeywords}" />
<meta name="description" content="{$metaDesc}" />
<meta content="IE=edge" http-equiv="X-UA-Compatible">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="Bookmark" href="favicon.ico">
<link rel="Shortcut Icon" href="favicon.ico">

<script src="http://js.spcrm.com/jQuery-1.7.1.min.js"
	type="text/javascript"></script>
<link type="text/css" rel="stylesheet"
	href="http://cdn.titles.top/css/common.css">
<link type="text/css" rel="stylesheet"
	href="http://cdn.titles.top/css/member.css">
	
<script src="http://cdn.titles.top/js/jquery.passwordStrength.js"
	type="text/javascript"></script>
</head>
<body>
	<!-- 顶部 -->
	[#include "/html/widget/topbar.html" /]

	<div id="header">
		<div class=" wrap">
			<div class="logobar">
				<a href="${store.domain}/index.html" title="返回首页" class=logo_member></a>
			</div>
			<div class="clear"></div>
		</div>
	</div>
	<div style="clear: both"></div>

	<div class="wrap" id="regist">
		<div class="mt">
			<ul class="tab">
				<li class="curr">用户注册</li>
				<!-- <li class="line"><a href="#">企业用户</a></li> -->
			</ul>
			<div class="extra">
				<span style="text-align: right">我已经注册，现在就&nbsp;<a href="${store.domain}/login.html" class="flk13">登录</a></span>
			</div>
		</div>
		<div class="mc">
			<form id="personRegForm" method="POST" onsubmit="return false;">
				<input type="hidden" name="siteId" value="${store.id}" />
				<div class="form">
					<div class="item" id="select-regName">
						<span class="label"><b class="ftx04">*</b>用户名：</span>

						<div class="fl item-ifo">
							<div class="o-intelligent-regName">
								<input type="text" id="regName" name="account" maxlength="20"
									class="text" tabindex="1" autocomplete="off"
									onpaste="return false;" value=""
									onfocus="if(this.value=='') this.value='';this.style.color='#333'"
									onblur="if(this.value=='') {this.value='';this.style.color='#999999'}">
								<i class="i-name"></i>
								<ul id="intelligent-regName" class="hide"></ul>
								<label id="regName_succeed" class="blank"></label> <label
									id="regName_error" class="hide"></label>
							</div>
						</div>
					</div>

					<div id="capslock">
						<i></i><s></s>键盘大写锁定已打开，请注意大小写
					</div>
					
					<div id="o-password">
						<div class="item">
							<span class="label"><b class="ftx04">*</b>请设置密码：</span>

							<div class="fl item-ifo">
								<input type="password" id="pwd" name="password" maxlength="20"
									class="text" tabindex="2" style="ime-mode: disabled;"
									onpaste="return  false" autocomplete="off"> <i
									class="i-pass"></i> 
								<label id="pwd_succeed" class="blank"></label>
								<label id="pwd_error"></label> <span class="clr"></span> 
								<label class="hide" id="pwdstrength"><span class="fl">安全程度：</span><b></b></label>
							</div>
						</div>

						<script type="text/javascript">
                        	$('#pwd')[0].onkeypress = function (event) {
                            var e = event || window.event,
                                    kc = e.keyCode || e.which, // 按键的keyCode
                                    isShift = e.shiftKey || (kc == 16 ) || false; // shift键是否按住
                            if (((kc >= 65 && kc <= 90) && !isShift) || ((kc >= 97 && kc <= 122) && isShift)) {
                            	$('#capslock').show();
                            }
                            else {
                            	$('#capslock').hide();
                            }
                        };
                    </script>

						<div class="item">
							<span class="label"><b class="ftx04">*</b>请确认密码：</span>
							<div class="fl item-ifo">
								<input type="password" id="pwdRepeat" name="pwdRepeat"
									maxlength="20" class="text" tabindex="3"
									onpaste="return  false" autocomplete="off"> <i
									class="i-pass"></i> 
								<label id="pwdRepeat_succeed" class="blank"></label>
								<label id="pwdRepeat_error"></label>
							</div>
						</div>
						<div class="item" id="dphone">
							<span class="label"><b class="ftx04">*</b>验证邮箱：</span>
							<div class="fl item-ifo">
								<input type="text" id="email" maxlength="50" name="email"
									class="text" tabindex="4" 
									autocomplete="off"> <i class="i-phone"></i> <label
									id="phone_succeed" class="blank"></label> <label
									id="phone_error"></label>
							</div>
							<!-- <div class="fl">
								<span class="ftx-03 ml5">或</span><a
									class="ftx-05 ml5 mail-verify"
									style="text-decoration: underline;" href="javascript:;">验证邮箱</a>
							</div> -->
						</div>
						<!-- <div id="mobileCodeDiv" class="item " style="height: 62px;">
							<span class="label"><b class="ftx04">*</b>短信验证码：</span>

							<div class="fl item-ifo">
								<input type="text" maxlength="6" autocomplete="off" tabindex="6"
									class="text text-1" name="mobileCode"
									style="ime-mode: disabled" id="mobileCode"
									onblur="mobileCodeBlur()" onfocus="mobileCodeFocus();">
								<label class="blank invisible"></label> <a class="btn"
									href="javascript:void(0);" onclick="sendMobileCode();"
									id="sendMobileCode"> <span id="dyMobileButton">获取短信验证码</span></a>
								<span class="clr"></span>

								<div class="msg-text" id="mobileCodeSucMessage"></div>
								<label id="mobileCode_error" class="blank"></label> <label
									id="mobileCode_succeed" class="blank invisible"></label>
							</div>
							<span class="clr"></span>
						</div>
					</div>
					<div class="item" id="authcodeDiv">
						<span class="label"><b class="ftx04">*</b>验证码：</span>

						<div class="fl item-ifo">
							<input type="text" id="authcode" style="ime-mode: disabled"
								name="authcode" class="text text-1" tabindex="6"
								autocomplete="off" maxlength="6"> 
								<label class="img">
								<img
								style="cursor: pointer; width: 100px; height: 36px; display: block;"
								onclick=""
								id="JD_Verification1"
								src="#">
							</label>
							<script type="text/javascript">$("#JD_Verification1").click();</script>
							<label class="ftx23">&nbsp;看不清？<a
								href="javascript:void(0)" onclick="setTimeout(verc,50);"
								class="flk13">换一张</a></label> <label id="authcode_succeed"
								class="blank invisible"></label> <span class="clr"></span> <label
								id="authcode_error"></label>
						</div>
					</div> -->
					<div class="item item-new">
						<span class="label">&nbsp;</span>
						<div class="fl item-ifo">
							<input type="checkbox" class="checkbox" checked="checked"
								id="readme" onclick="agreeonProtocol();"> <label
								for="protocol">我已阅读并同意<a href="#" class="blue"
								id="protocol">《**用户注册协议》</a></label> <span class="clr"></span> <label
								id="protocol_error" class="error hide">请接受服务条款</label>
						</div>
					</div>
					<div class="item">
						<span class="label">&nbsp;</span> 
						<input type="button" class="btn-img btn-regist" id="registsubmit" value="立即注册"
							tabindex="8" 
							onclick="reg();">
					</div>
				</div>
				<div class="phone">
					<!-- <img width="180" height="180" src="#"> -->
				</div>
			</div>
				<span class="clr"></span>
			</form>
			
			<div id="regist-result">
				
			
			</div>
		</div>
	</div>
	
	<script type="text/javascript">
	$(function () {
        $("#pwd").passwordStrength();
        $("#pwd").keyup(function(){
        	$("#pwdstrength").removeClass("hide");
        });
    });
	
	$("#registsubmit").mouseover(function(){
		  $(this).addClass("hover-btn");
		  $(this).css("cursor","pointer");
	});
	$("#registsubmit").mouseout(function(){
		  $(this).removeClass("hover-btn");
	});
	
	function validRegname(account){
		$.ajax({
			url : domain+'/ckAccount?account='+account,
			dataType : 'json',
			type : 'POST',
			success : function(json) {
				return json.success;
			}
		});
	}
	function reg(){
		var uname = $("#regName").val();
		var upwd = $("#pwd").val();
		var pwdRepeat = $("#pwdRepeat").val();
		var email =$("#email").val();
		if (uname==""){
			$("#regName_error").show();
			$("#regName_error").addClass("error");
			$("#regName_error").text("用户名不能为空。");
			return false;
		}else if(!validRegname(uname)){
			$("#regName_error").show();
			$("#regName_error").addClass("error");
			$("#regName_error").text("用户名已经被使用。");
		}else{
			$("#regName_succeed").addClass("succeed");
		}
		if (upwd==""){
			$("#pwd_error").addClass("error");
			$("#pwd_error").text("密码不能为空。");
			return false;
		}else{
			$("#pwd_succeed").addClass("succeed");
		}
		if (upwd!=pwdRepeat){
			$("#pwdRepeat_error").addClass("error");
			$("#pwdRepeat_error").text("两次输入密码不一致");
			return false;
		}else{
			$("#pwdRepeat_succeed").addClass("succeed");
		}
		
		if (email==""){
			$("#phone_error").addClass("error");
			$("#phone_error").text("邮箱不能为空！");
			return false;
		}else if (!email.match(/^\w+((-\w+)|(\.\w+))*\@[A-Za-z0-9]+((\.|-)[A-Za-z0-9]+)*\.[A-Za-z0-9]+$/)) {
			$("#phone_error").addClass("error");
			$("#phone_error").text("邮箱地址错误！");
			return false;
		}else{
			$("#phone_succeed").addClass("succeed");
		}
		
		$.ajax({
			url : domain+'/regist',
			data : $("#personRegForm").serialize(),
			dataType : 'json',
			type : 'POST',
			success : function(json) {
				if(json.success) {
					var msghtml="恭喜你帐号["+json.data.account+"]注册成功。请<a href='${store.domain}/login.html'>&nbsp;登录&nbsp;</>";
					$("#personRegForm").hide();
					$("#regist-result").html(msghtml);
				}else{
					alert(json.success);
					alert(json.msg);
				}
			}
		}); 		
	}
	</script>
	<!-- 尾部-->
	[#include "/html/widget/footer.html" /]
	<!-- footer end -->
</body>
</html>
